<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Juego de Serenito y sus vecinos</title>
    <link rel="icon" type="image/png" href="ls-favicon.png">
    
    <style>
        body { margin: 0; overflow: hidden; background-color: #333; }
        canvas { display: block; background-color: #87CEEB; /* Celeste cielo */ }
    </style>
</head>
<body>

<canvas id="gameCanvas"></canvas>

<script>
    // === CONFIGURACIÓN BÁSICA ===
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    // Ajustar al tamaño de la pantalla
    function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    // === VARIABLES DEL JUEGO ===
    // Serenito (El héroe)
    const serenito = {
        x: 100,
        y: 300,
        ancho: 40,
        alto: 60,
        velocidad: 5,
        color: 'salmon' // O tu sprite si ya lo tenías cargado
    };

    // La Municipalidad (Datos para ubicarla)
    const muni = {
        x: 0, // Se calculará en el bucle
        y: 0,
        ancho: 150,
        alto: 300
    };

    // Imágenes (Si las tienes, descomenta las líneas de carga)
    // const imgMuni = new Image(); imgMuni.src = 'municipalidad.png';
    // const imgSerenito = new Image(); imgSerenito.src = 'serenito.png';

    // === CONTROLES ===
    const teclas = {};
    window.addEventListener('keydown', e => teclas[e.key] = true);
    window.addEventListener('keyup', e => teclas[e.key] = false);

    // === BUCLE PRINCIPAL (EL MOTOR) ===
    function gameLoop() {
        // 1. Limpiar pantalla
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // 2. Lógica de Movimiento
        if (teclas['ArrowRight']) serenito.x += serenito.velocidad;
        if (teclas['ArrowLeft']) serenito.x -= serenito.velocidad;
        // Límites
        if (serenito.x < 0) serenito.x = 0;
        if (serenito.x > canvas.width - serenito.ancho) serenito.x = canvas.width - serenito.ancho;

        // 3. DIBUJAR EL SUELO
        ctx.fillStyle = "#4CAF50"; // Verde pasto
        ctx.fillRect(0, canvas.height - 100, canvas.width, 100);

        // 4. DIBUJAR LA MUNICIPALIDAD (GIRADA 90 GRADOS)
        dibujarMuniRotada();

        // 5. DIBUJAR A SERENITO
        // Si tienes imagen: ctx.drawImage(imgSerenito, serenito.x, serenito.y, ...);
        // Si no, usamos el cuadro base:
        ctx.fillStyle = serenito.color;
        ctx.fillRect(serenito.x, serenito.y, serenito.ancho, serenito.alto);

        requestAnimationFrame(gameLoop);
    }

    // === FUNCIÓN ESPECIAL DE ROTACIÓN ===
    function dibujarMuniRotada() {
        ctx.save(); // Guardar estado normal

        // Posición base de la muni (Esquina derecha, ajustada al suelo)
        let posX = canvas.width - 200;
        let posY = canvas.height - 150;

        // 1. Mover el punto de origen al lugar de la Muni
        ctx.translate(posX, posY);

        // 2. Rotar 90 grados a la izquierda (anti-horario)
        ctx.rotate(-Math.PI / 2); 

        // 3. Dibujar el edificio (Rectángulo o Imagen)
        // Nota: Al rotar, los ejes X e Y cambian de sentido relativo
        ctx.fillStyle = "#CCC"; // Gris edificio
        ctx.fillRect(0, 0, muni.ancho, muni.alto); // Dibuja el edificio "acostado" por la rotación
        
        // Detalles visuales para saber qué es arriba/abajo
        ctx.fillStyle = "#800000"; // Techo rojo
        ctx.fillRect(0, 0, muni.ancho, 20); // Una franja
        
        ctx.fillStyle = "black";
        ctx.fillText("MUNICIPALIDAD", 10, 50);

        ctx.restore(); // Restaurar estado normal para que Serenito no salga chueco
    }

    // Iniciar
    gameLoop();

</script>
</body>
</html>
